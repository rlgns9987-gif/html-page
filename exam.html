<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>ë§¤ê²½í…ŒìŠ¤íŠ¸ 80ë¶„ ì‹¤ì „ ëª¨ì˜ê³ ì‚¬</title>
    <style>
        :root { --primary: #3498db; --secondary: #2c3e50; --bg: #f5f7f9; }
        body { font-family: 'Malgun Gothic', sans-serif; background-color: var(--bg); margin: 0; padding: 20px; color: #333; }
        .container { max-width: 850px; margin: 0 auto; background: #fff; padding: 40px; border-radius: 15px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); }
        
        /* í—¤ë” & ì •ë³´ */
        .header { display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid var(--primary); padding-bottom: 15px; margin-bottom: 30px; }
        .timer { font-size: 1.5em; font-weight: bold; color: #e74c3c; }
        .progress-container { width: 100%; background: #eee; height: 10px; border-radius: 5px; margin-bottom: 20px; overflow: hidden; }
        .progress-bar { background: var(--primary); height: 100%; width: 0%; transition: 0.3s; }

        /* ë¬¸ì œ ì˜ì—­ */
        .q-title { font-size: 1.3em; font-weight: bold; margin-bottom: 25px; line-height: 1.5; }
        .options { display: flex; flex-direction: column; gap: 12px; }
        .opt-btn { padding: 18px; border: 1px solid #ddd; border-radius: 10px; background: #fff; cursor: pointer; text-align: left; font-size: 1.1em; transition: 0.2s; }
        .opt-btn:hover { background: #eef7ff; border-color: var(--primary); }
        .opt-btn.selected { background: var(--primary); color: white; border-color: var(--primary); }

        /* ë„¤ë¹„ê²Œì´ì…˜ */
        .nav-btns { display: flex; justify-content: space-between; margin-top: 40px; }
        .nav-btns button { padding: 12px 30px; border-radius: 5px; cursor: pointer; border: none; font-size: 1em; font-weight: bold; }
        .prev-btn { background: #95a5a6; color: white; }
        .next-btn { background: var(--primary); color: white; }
        .submit-btn { background: #27ae60; color: white; display: none; }

        /* ê²°ê³¼ ì°½ */
        #result-screen { display: none; text-align: center; }
        .score-circle { width: 150px; height: 150px; border-radius: 50%; border: 8px solid var(--primary); margin: 20px auto; display: flex; align-items: center; justify-content: center; font-size: 2.5em; font-weight: bold; }
        .wrong-list { text-align: left; margin-top: 30px; max-height: 400px; overflow-y: auto; padding: 15px; border: 1px solid #eee; }
        .wrong-item { margin-bottom: 20px; padding-bottom: 10px; border-bottom: 1px dashed #ccc; }
        .explanation { color: #666; font-size: 0.9em; background: #fdf9f2; padding: 10px; border-left: 3px solid #f1c40f; margin-top: 5px; }
    </style>
</head>
<body>

<div class="container" id="quiz-screen">
    <div class="header">
        <div><strong>ë§¤ê²½í…ŒìŠ¤íŠ¸ ì‹¤ì „ ëª¨ì˜ê³ ì‚¬</strong> (80ë¬¸í•­)</div>
        <div class="timer" id="timer">80:00</div>
    </div>
    
    <div class="progress-container"><div class="progress-bar" id="progress-bar"></div></div>
    
    <div id="quiz-area">
        <div class="q-title" id="q-title"></div>
        <div class="options" id="options-area"></div>
    </div>

    <div class="nav-btns">
        <button class="prev-btn" onclick="prevQ()">ì´ì „</button>
        <div id="q-num-info" style="align-self: center;">1 / 80</div>
        <button class="next-btn" id="next-btn" onclick="nextQ()">ë‹¤ìŒ</button>
        <button class="submit-btn" id="submit-btn" onclick="showResults()">ìµœì¢… ì œì¶œ</button>
    </div>
</div>

<div class="container" id="result-screen">
    <h2>ì‹œí—˜ ê²°ê³¼</h2>
    <div class="score-circle" id="final-score">0ì </div>
    <p id="score-comment"></p>
    <hr>
    <h3>ì˜¤ë‹µ ë…¸íŠ¸ ë° í•´ì„¤</h3>
    <div class="wrong-list" id="wrong-list"></div>
    <button class="next-btn" onclick="location.reload()" style="margin-top:20px">ë‹¤ì‹œ í’€ê¸°</button>
</div>

<script>
let allQuestions = []; // ì „ì²´ ë¬¸ì œ ì €ì¥ìš©
    let examData = [];     // ì´ë²ˆ ì‹œí—˜ìš© 80ë¬¸ì œ
    let userAnswers = new Array(80).fill(null);
    let currentIdx = 0;
    let timeLeft = 80 * 60; // 80ë¶„

    // [ìˆ˜ì •] ì™¸ë¶€ JSON íŒŒì¼ì„ ë¶ˆëŸ¬ì˜¤ëŠ” í•¨ìˆ˜
    async function loadDataAndInit() {
        try {
            // data.json íŒŒì¼ì„ ë¶ˆëŸ¬ì˜µë‹ˆë‹¤.
            const response = await fetch('data.json'); 
            
            if (!response.ok) {
                throw new Error('ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.');
            }

            allQuestions = await response.json();
            
            // ë°ì´í„° ë¡œë“œ ì„±ê³µ í›„ ì‹œí—˜ ì‹œì‘
            initExam();
        } catch (error) {
            console.error(error);
            alert('data.json íŒŒì¼ì„ ì°¾ì„ ìˆ˜ ì—†ê±°ë‚˜ í˜•ì‹ì´ ì˜ëª»ë˜ì—ˆìŠµë‹ˆë‹¤. ì„œë²„(Live Server ë“±)ë¥¼ í†µí•´ ì‹¤í–‰ ì¤‘ì¸ì§€ í™•ì¸í•˜ì„¸ìš”.');
        }
    }

    function initExam() {
        if (allQuestions.length < 80) {
            alert(`ë¬¸ì œê°€ ë¶€ì¡±í•©ë‹ˆë‹¤. í˜„ì¬: ${allQuestions.length}ê°œ (í•„ìš”: 80ê°œ)`);
            return;
        }
        // ëœë¤ ì„ê¸° ë° 80ë¬¸ì œ ì¶”ì¶œ
        const shuffled = [...allQuestions].sort(() => Math.random() - 0.5);
        examData = shuffled.slice(0, 80);
        
        renderQuestion();
        startTimer();
    }


    function renderQuestion() {
        const q = examData[currentIdx];
        document.getElementById('q-title').innerText = `Q${currentIdx + 1}. ${q.q}`;
        document.getElementById('q-num-info').innerText = `${currentIdx + 1} / 80`;
        
        const optionsArea = document.getElementById('options-area');
        optionsArea.innerHTML = '';

        q.options.forEach((opt, i) => {
            const btn = document.createElement('button');
            btn.className = `opt-btn ${userAnswers[currentIdx] === i ? 'selected' : ''}`;
            btn.innerText = `${i + 1}. ${opt}`;
            btn.onclick = () => selectOption(i);
            optionsArea.appendChild(btn);
        });

        // ì§„í–‰ë°” ì—…ë°ì´íŠ¸
        document.getElementById('progress-bar').style.width = `${((currentIdx + 1) / 80) * 100}%`;

        // ë²„íŠ¼ ë…¸ì¶œ ì œì–´
        document.getElementById('next-btn').style.display = currentIdx === 79 ? 'none' : 'block';
        document.getElementById('submit-btn').style.display = currentIdx === 79 ? 'block' : 'none';
    }

    function selectOption(idx) {
        userAnswers[currentIdx] = idx;
        renderQuestion();
    }

    function nextQ() { if (currentIdx < 79) { currentIdx++; renderQuestion(); } }
    function prevQ() { if (currentIdx > 0) { currentIdx--; renderQuestion(); } }

    function startTimer() {
        const timerEl = document.getElementById('timer');
        const interval = setInterval(() => {
            let mins = Math.floor(timeLeft / 60);
            let secs = timeLeft % 60;
            timerEl.innerText = `${mins.toString().padStart(2, '0')}:${secs.toString().padStart(2, '0')}`;
            if (timeLeft <= 0) {
                clearInterval(interval);
                alert("ì‹œí—˜ ì‹œê°„ì´ ì¢…ë£Œë˜ì—ˆìŠµë‹ˆë‹¤!");
                showResults();
            }
            timeLeft--;
        }, 1000);
    }

    function showResults() {
        document.getElementById('quiz-screen').style.display = 'none';
        document.getElementById('result-screen').style.display = 'block';

        let score = 0;
        const wrongList = document.getElementById('wrong-list');
        wrongList.innerHTML = '';

        examData.forEach((q, i) => {
            if (userAnswers[i] === q.answer) {
                score++;
            } else {
                // ì˜¤ë‹µ í•­ëª© ì¶”ê°€
                const div = document.createElement('div');
                div.className = 'wrong-item';
                div.innerHTML = `
                    <strong>Q${i + 1}. ${q.q}</strong><br>
                    <span style="color:red">ì„ íƒ: ${userAnswers[i] !== null ? q.options[userAnswers[i]] : 'ë¯¸ë‹µë³€'}</span> / 
                    <span style="color:blue">ì •ë‹µ: ${q.options[q.answer]}</span>
                    <div class="explanation">ğŸ’¡ í•´ì„¤: ${q.ext}</div>
                `;
                wrongList.appendChild(div);
            }
        });

        const finalScore = Math.round((score / 80) * 1000); // 1000ì  ë§Œì ìœ¼ë¡œ í™˜ì‚°
        document.getElementById('final-score').innerText = `${finalScore}ì `;
        
        let comment = "ì•„ì‰¬ìš´ ì ìˆ˜ë„¤ìš”. ìœ„ë“œì—ë“€ ìë£Œë¥¼ ë” í•™ìŠµí•´ ë³´ì„¸ìš”!";
        if (finalScore >= 800) comment = "ìš°ìˆ˜í•œ ì„±ì ì…ë‹ˆë‹¤! ìµœìš°ìˆ˜ ë“±ê¸‰ì´ ê¸°ëŒ€ë©ë‹ˆë‹¤.";
        else if (finalScore >= 600) comment = "ì•ˆì •ì ì¸ í•©ê²©ê¶Œ(ìš°ìˆ˜ ë“±ê¸‰)ì…ë‹ˆë‹¤.";
        
        document.getElementById('score-comment').innerText = comment;
    }

    window.onload = loadDataAndInit;
</script>

</body>
</html>